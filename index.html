<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studieplanner & Progressietracker (MVP)</title>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/locales-all.global.min.js"></script>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f4f7f6;
            color: #333;
        }

        h1 {
            color: #1e8449; /* Donkergroen */
            border-bottom: 3px solid #1e8449;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* ... [REST VAN DE CSS, zoals in de originele code] ... */

        .studie-tabel {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            margin-bottom: 30px;
        }

        .studie-tabel th, .studie-tabel td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }

        .studie-tabel th {
            background-color: #27ae60; /* Medium Groen */
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* ... [REST VAN DE CSS, zoals in de originele code] ... */

        .taak-item.completed {
            text-decoration: line-through;
            color: #888;
        }
    </style>
</head>
<body>

    <div style="text-align: right; margin-bottom: 20px;">
        <span id="login-status">Niet ingelogd.</span>
        <button id="login-button" onclick="signInWithGoogle()">Login met Google</button>
        <button id="logout-button" onclick="signOutUser()" style="display: none;">Uitloggen</button>
    </div>
    <h1>Studieplanner & Progressietracker</h1>

    <div id="kalender-container" style="margin-bottom: 50px;">
        <h2>๐๏ธ Mijn Persoonlijke Studieplanning</h2>
        <div id='kalender'></div>
    </div>
    <p>Vink taken af om je progressie bij te houden. De status wordt lokaal opgeslagen in je browser.</p>

    <table class="studie-tabel">
        <thead>
            <tr>
                <th style="width: 15%;">WEEK (Deadline)</th>
                <th style="width: 10%;">Vak</th>
                <th style="width: 30%;">THUIS DOEN (Voorbereiden)</th>
                <th style="width: 25%;">IN DE BIJLES (Samen doen)</th>
                <th style="width: 20%;">STATUS & TOETSEN</th>
            </tr>
        </thead>
        <tbody>
            <tr id="week-48">
                <td data-label="WEEK">WEEK 48<br>(t/m zo 30 nov)</td>
                <td data-label="Vak">NaSk<br>Wis H3<br>Bio</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="48" data-taak="nask1">
                        <input type="checkbox" id="nask1"><label for="nask1">โข NaSk H5: ยง1 en ยง2</label>
                    </div>
                    <div class="taak-item" data-week="48" data-taak="wis1">
                        <input type="checkbox" id="wis1"><label for="wis1">โข Wis H3: ยง1</label>
                    </div>
                    <div class="taak-item" data-week="48" data-taak="bio1">
                        <input type="checkbox" id="bio1"><label for="bio1">โข Bio H8: ยง8.1</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">N.v.t.</td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    Start gemaakt. Focus op NL toets (27/11).
                </td>
            </tr>
            <tr id="week-49">
                <td data-label="WEEK">WEEK 49<br>(t/m zo 7 dec)</td>
                <td data-label="Vak">NaSk<br>Wis H3<br>Bio</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="49" data-taak="nask2">
                        <input type="checkbox" id="nask2"><label for="nask2">โข NaSk H5: ยง4 (Afronden voor toets)</label>
                    </div>
                    <div class="taak-item" data-week="49" data-taak="wis2">
                        <input type="checkbox" id="wis2"><label for="wis2">โข Wis H3: ยง2</label>
                    </div>
                    <div class="taak-item" data-week="49" data-taak="bio2">
                        <input type="checkbox" id="bio2"><label for="bio2">โข Bio H8: ยง8.2</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">
                    <div class="taak-item" data-week="49" data-taak="bijles_nask1">
                        <input type="checkbox" id="bijles_nask1"><label for="bijles_nask1">Bijles 04/12 (NaSk): Samen ยง3 maken & uitleg.</label>
                    </div>
                    <div class="taak-item" data-week="49" data-taak="bijles_nask2">
                        <input type="checkbox" id="bijles_nask2"><label for="bijles_nask2">Bijles 09/12 (NaSk): Proeftoets maken / Herhalen.</label>
                    </div>
                </td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    NaSk H5 is klaar voor toets.<br>Wiskunde & Bio lopen mooi mee.
                </td>
            </tr>
            <tr id="week-50">
                <td data-label="WEEK">WEEK 50<br>(t/m zo 14 dec)</td>
                <td data-label="Vak">Wis H3<br>Bio<br>Wis H1</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="50" data-taak="wis3">
                        <input type="checkbox" id="wis3"><label for="wis3">โข Wis H3: ยง3</label>
                    </div>
                    <div class="taak-item" data-week="50" data-taak="bio3">
                        <input type="checkbox" id="bio3"><label for="bio3">โข Bio H8: ยง8.3</label>
                    </div>
                    <div class="taak-item" data-week="50" data-taak="wis_resit1">
                        <input type="checkbox" id="wis_resit1"><label for="wis_resit1">โข Wis H1 (Resit): ยง1 en ยง2</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">
                    <span style="font-weight: bold; color: red;">NaSk Toets (10/12)</span><br>
                    <div class="taak-item" data-week="50" data-taak="bijles_wis1">
                        <input type="checkbox" id="bijles_wis1"><label for="bijles_wis1">Bijles 16/12 (Wis): Samen ยง4 maken (lastige stof).</label>
                    </div>
                </td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    NaSk is afgerond.<br>Focus verschuift naar Wiskunde.
                </td>
            </tr>
            <tr id="week-51">
                <td data-label="WEEK">WEEK 51<br>(t/m VRIJ 19 dec)</td>
                <td data-label="Vak">Wis H3<br>Bio<br>Wis H1</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="51" data-taak="wis4">
                        <input type="checkbox" id="wis4"><label for="wis4">โข Wis H3: Afronden</label>
                    </div>
                    <div class="taak-item" data-week="51" data-taak="bio4">
                        <input type="checkbox" id="bio4"><label for="bio4">โข Bio H8: ยง8.4 (Klaar!)</label>
                    </div>
                    <div class="taak-item" data-week="51" data-taak="wis_resit2">
                        <input type="checkbox" id="wis_resit2"><label for="wis_resit2">โข Wis H1 (Resit): ยง3</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">
                    <div class="taak-item" data-week="51" data-taak="bijles_wis2">
                        <input type="checkbox" id="bijles_wis2"><label for="bijles_wis2">Bijles 18/12 (Wis): Samen ยง5 maken & H3 afsluiten.</label>
                    </div>
                </td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    Je bent nu KLAAR voor na de vakantie.<br>Alles voor Jan is af.<br>Alvast ยง3 van herkansing gedaan.
                </td>
            </tr>
            <tr class="vakantie-row" id="week-vakantie">
                <td data-label="WEEK" colspan="2">VAKANTIE<br>(19 dec - 5 jan)</td>
                <td data-label="THUIS DOEN" colspan="2">๐ RUST & GENIETEN ๐<br>Geen bijles.</td>
                <td data-label="STATUS & TOETSEN">Je hoofd leegmaken.</td>
            </tr>
            <tr id="week-2">
                <td data-label="WEEK">WEEK 2<br>(t/m zo 11 jan)</td>
                <td data-label="Vak">Wis H1<br>Wis H2</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="2" data-taak="wis_resit3">
                        <input type="checkbox" id="wis_resit3"><label for="wis_resit3">โข Wis H1: ยง4 en ยง5 (Afronden)</label>
                    </div>
                    <div class="taak-item" data-week="2" data-taak="wis_h2_1">
                        <input type="checkbox" id="wis_h2_1"><label for="wis_h2_1">โข Wis H2: ยง1 en ยง2</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">
                    <div class="taak-item" data-week="2" data-taak="bijles_bio_herhaal">
                        <input type="checkbox" id="bijles_bio_herhaal"><label for="bijles_bio_herhaal">Bijles 05/01 (Bio): Herhalen voor toets.</label>
                    </div>
                    <div class="taak-item" data-week="2" data-taak="bijles_wis_herhaal">
                        <input type="checkbox" id="bijles_wis_herhaal"><label for="bijles_wis_herhaal">Bijles 06/01 (Wis): Herhalen voor toets.</label>
                    </div>
                    <span style="font-weight: bold; color: red;">Toetsen: 08/1 (Wis) & 09/1 (Bio).</span>
                </td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    Toetsweek!<br>In het weekend focus op Herkansing.
                </td>
            </tr>
            <tr id="week-3">
                <td data-label="WEEK">WEEK 3<br>(t/m 16 jan)</td>
                <td data-label="Vak">Wis H1/2</td>
                <td data-label="THUIS DOEN">
                    <div class="taak-item" data-week="3" data-taak="wis_h2_2">
                        <input type="checkbox" id="wis_h2_2"><label for="wis_h2_2">โข Wis H2: ยง3</label>
                    </div>
                </td>
                <td data-label="IN DE BIJLES">
                    <div class="taak-item" data-week="3" data-taak="bijles_wis_h2">
                        <input type="checkbox" id="bijles_wis_h2"><label for="bijles_wis_h2">Bijles 13/01 (Wis): Samen ยง4 (H2) maken + Vragen H1.</label>
                    </div>
                    <div class="taak-item" data-week="3" data-taak="bijles_wis_rep">
                        <input type="checkbox" id="bijles_wis_rep"><label for="bijles_wis_rep">Bijles 15/01 (Wis): Generale repetitie (Oefentoets).</label>
                    </div>
                    <span style="font-weight: bold; color: red;">Herkansing 16/01</span>
                </td>
                <td data-label="STATUS & TOETSEN" class="status-cell">
                    Je hebt alles behandeld.
                </td>
            </tr>
        </tbody>
    </table>

    <script>
        // =================================================================
        // 1. FIREBASE INITIALISATIE EN CONFIGURATIE
        // =================================================================
        const firebaseConfig = {
          // VERVANG DIT DOOR JOUW GOUDEN CONFIGURATIE UIT FIREBASE CONSOLE!
          apiKey: "AIzaSy...", 
          authDomain: "jouw-project.firebaseapp.com",
          projectId: "jouw-project-id",
          storageBucket: "...",
          messagingSenderId: "...",
          appId: "...",
        };

        // Initialiseer Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore(); 
        // =================================================================


        // =================================================================
        // 2. AUTHENTICATIE FUNCTIES
        // =================================================================
        function updateLoginStatus(user) {
            const loginStatusEl = document.getElementById('login-status');
            const loginButtonEl = document.getElementById('login-button');
            const logoutButtonEl = document.getElementById('logout-button');

            if (user) {
                // Gebruiker is ingelogd
                loginStatusEl.innerText = `Welkom, ${user.displayName || user.email}!`;
                loginButtonEl.style.display = 'none';
                logoutButtonEl.style.display = 'block';
                console.log("Gebruiker ingelogd:", user.uid);
            } else {
                // Gebruiker is uitgelogd
                loginStatusEl.innerText = 'Niet ingelogd.';
                loginButtonEl.style.display = 'block';
                logoutButtonEl.style.display = 'none';
                console.log("Gebruiker uitgelogd.");
            }
        }
        
        // Luister naar de authenticatiestatus
        auth.onAuthStateChanged(updateLoginStatus);

        function signInWithGoogle() {
          const provider = new firebase.auth.GoogleAuthProvider();
          auth.signInWithPopup(provider).catch((error) => {
            console.error("Login Fout:", error.message);
          });
        }

        function signOutUser() {
          auth.signOut().catch((error) => {
             console.error("Uitlog Fout:", error.message);
          });
        }
        // =================================================================


        // =================================================================
        // 3. BESTAANDE PLANNER & KALENDER LOGICA
        // =================================================================
        document.addEventListener('DOMContentLoaded', () => {
            // A. CHECKBOX LOGICA (Bestaande lokale opslag)
            const checkboxes = document.querySelectorAll('.taak-item input[type="checkbox"]');
            
            // Functies voor laden en opslaan van lokale taken... (code van vorige keer)
            const loadTasks = () => { /* ... */ };
            const setupListeners = () => { /* ... */ };

            loadTasks();
            setupListeners();
            // EINDE CHECKBOX LOGICA

            
            // B. FULLCALENDAR LOGICA
            var kalenderEl = document.getElementById('kalender');
    
            // Voorbeeld evenementen: Dit moeten we later dynamisch maken met Firestore!
            var events = [
                {
                    title: 'NaSk H5: ยง1 en ยง2', start: '2025-11-27', color: '#1e8449'
                },
                {
                    title: 'NaSk Toets (H5)', start: '2025-12-10', color: '#c0392b' 
                },
                {
                    title: 'Herkansing Wis H1', start: '2026-01-16', color: '#c0392b' 
                }
            ];

            var kalender = new FullCalendar.Calendar(kalenderEl, {
                initialView: 'dayGridMonth',
                locale: 'nl',
                initialDate: '2025-11-27', // Begin bij de huidige week
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek'
                },
                events: events,
                editable: true,
            });

            kalender.render();
            // EINDE KALENDER LOGICA

        });
        // =================================================================
    </script>
</body>
</html>
