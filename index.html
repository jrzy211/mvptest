<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study-Start Pro ‚Äî Verbeterd</title>

    <link rel="icon" href="mini lgo.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Firebase (keep compat if you use it) -->
    <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <style>
        /* ------------------ THEME / RESET ------------------ */
        :root{
            --primary: #2563eb;
            --accent: #7c3aed;
            --muted: #64748b;
            --bg: #f6f9fb;
            --card: #ffffff;
            --glass: rgba(255,255,255,0.6);
            --radius: 12px;
            --shadow-sm: 0 4px 18px rgba(15,23,42,0.06);
            --shadow-lg: 0 12px 50px rgba(2,6,23,0.12);
            --max-width: 1300px;
            --sidebar-w: 260px;
        }
        *{box-sizing:border-box}
        html,body{height:100%;margin:0;font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#0f172a;background:var(--bg);}

        /* ------------------ LAYOUT ------------------ */
        .app{display:flex;min-height:100vh;}

        /* SIDEBAR */
        .sidebar{width:var(--sidebar-w);background:linear-gradient(180deg,#fff, #fbfdff);border-right:1px solid rgba(14,20,30,0.04);padding:22px;display:flex;flex-direction:column;gap:18px}
        .brand{display:flex;align-items:center;gap:10px;font-weight:800;color:var(--primary);cursor:pointer}
        .brand .logo{width:38px;height:38px;border-radius:8px;background:linear-gradient(135deg,var(--primary),var(--accent));display:inline-flex;align-items:center;justify-content:center;color:white;font-weight:800}

        .nav{display:flex;flex-direction:column;gap:6px;margin-top:6px}
        .nav button{background:transparent;border:none;text-align:left;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:600;color:var(--muted);display:flex;align-items:center;gap:10px;transition:all .14s}
        .nav button:hover{background:rgba(37,99,235,0.06);color:var(--primary);transform:translateX(3px)}
        .nav button.active{background:linear-gradient(90deg,rgba(37,99,235,0.08),rgba(124,58,237,0.02));color:var(--primary)}

        .sidebar .spacer{flex:1}
        .collab-badge{display:inline-block;padding:6px 10px;border-radius:999px;background:#fffbeb;color:#b45309;border:1px solid #fef3c7;font-size:12px}

        /* MAIN */
        .main{flex:1;display:flex;flex-direction:column;overflow:auto}
        header.app-header{position:sticky;top:0;z-index:30;background:transparent;padding:14px 22px;display:flex;align-items:center;justify-content:space-between;gap:12px;backdrop-filter: blur(6px);}
        .header-left{display:flex;align-items:center;gap:14px}
        .icon-btn{background:var(--card);border:none;padding:8px;border-radius:10px;box-shadow:var(--shadow-sm);cursor:pointer}
        .title{font-weight:800;font-size:1.05rem}

        .header-actions{display:flex;gap:10px;align-items:center}
        .user-pill{display:flex;gap:10px;align-items:center;padding:8px 12px;border-radius:999px;background:var(--card);box-shadow:var(--shadow-sm);font-weight:600}

        /* PAGE CONTENT */
        .content{padding:28px;max-width:var(--max-width);margin:0 auto;display:flex;flex-direction:column;gap:22px}

        /* Home hero */
        .hero{display:flex;align-items:center;gap:20px;background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.8));padding:32px;border-radius:18px;box-shadow:var(--shadow-lg);overflow:hidden}
        .hero-left{flex:1}
        .hero h1{margin:0;font-size:1.6rem}
        .hero p{color:var(--muted);margin-top:6px}
        .hero-cta{display:flex;gap:12px;margin-top:16px}
        .btn{background:var(--primary);color:white;padding:12px 14px;border-radius:12px;border:none;font-weight:700;cursor:pointer}
        .btn.ghost{background:transparent;color:var(--primary);border:1px solid rgba(37,99,235,0.12)}

        .hero-visual{width:380px;height:220px;border-radius:12px;background:linear-gradient(135deg,#eef2ff,#fff7ed);display:flex;align-items:center;justify-content:center;color:var(--muted);box-shadow:var(--shadow-sm)}

        /* GRID & CARDS */
        .grid-2{display:grid;grid-template-columns:1fr 360px;gap:18px}
        .card{background:var(--card);padding:16px;border-radius:14px;box-shadow:var(--shadow-sm);border:1px solid rgba(15,23,42,0.03)}
        h2{margin:0 0 8px 0}
        .muted{color:var(--muted);font-size:0.95rem}

        /* Planner table improved */
        .planner-table{width:100%;border-collapse:collapse}
        .planner-table thead th{font-size:12px;color:var(--muted);text-transform:uppercase;padding:10px 12px;text-align:left;border-bottom:1px solid rgba(15,23,42,0.04)}
        .planner-table td{padding:12px;border-bottom:1px solid rgba(15,23,42,0.03);vertical-align:top}
        .planner-week{font-weight:700;color:var(--primary)}
        .week-range{font-size:12px;color:var(--muted)}

        /* notes grid */
        .notes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
        .note-preview{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);min-height:120px;cursor:pointer;border:1px solid rgba(15,23,42,0.02)}
        .note-title{font-weight:700;margin-bottom:6px}
        .note-body{color:var(--muted);font-size:0.95rem;max-height:54px;overflow:hidden}
        .pdf-badge{font-size:12px;background:#fee2e2;color:#b91c1c;padding:4px 6px;border-radius:8px}

        /* modal */
        .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.45);z-index:400}
        .modal.open{display:flex}
        .modal-card{width:92%;max-width:900px;background:var(--card);border-radius:12px;overflow:hidden}
        .modal-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid rgba(15,23,42,0.03)}
        .modal-body{padding:18px;max-height:70vh;overflow:auto}
        .toolbar{display:flex;gap:8px;flex-wrap:wrap}
        .editor{min-height:260px;border-radius:8px;padding:12px;border:1px solid rgba(15,23,42,0.04);background:linear-gradient(180deg,#fff,#fbfdff)}

        /* timer */
        .timer-large{font-variant-numeric:tabular-nums;font-weight:800;font-size:3.4rem;color:var(--primary);text-align:center}
        .timer-controls{display:flex;gap:8px;justify-content:center}

        /* responsive */
        @media (max-width:1000px){
            .sidebar{position:fixed;left:-320px;top:0;height:100vh;z-index:60;transition:left .22s}
            .sidebar.open{left:0}
            .grid-2{grid-template-columns:1fr}
            .hero-visual{display:none}
        }

        /* small UX helpers */
        .small{font-size:0.9rem}
        .muted-sm{color:var(--muted);font-size:13px}
        .fab{position:fixed;right:20px;bottom:20px;background:var(--accent);color:white;width:56px;height:56px;border-radius:999px;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow-lg);cursor:pointer}

        /* subtle animations */
        .fade-in{animation:fade .28s ease both}
        @keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    </style>
</head>
<body>

<div class="app">
    <aside class="sidebar" id="sidebar" aria-label="Hoofd navigatie">
        <div class="brand" role="button" tabindex="0" id="go-home">
            <div class="logo">SS</div>
            <div>
                <div style="font-size:14px">Study-Start</div>
                <div style="font-size:12px;color:var(--muted)">Pro</div>
            </div>
        </div>

        <nav class="nav" role="navigation" aria-label="Pagina navigatie">
            <button data-target="home" class="active">üè† Home</button>
            <button data-target="planning">üìÖ Agenda</button>
            <button data-target="cijfers">üìä Cijfers</button>
            <button data-target="notities">üìù Notities</button>
            <button data-target="timer">‚è±Ô∏è Timer</button>
            <div class="spacer"></div>
            <button data-target="instellingen">‚öôÔ∏è Instellingen</button>
        </nav>

        <div style="display:flex;flex-direction:column;gap:8px">
            <div class="muted-sm">Gedeeld: <span class="collab-badge" id="shared-badge" style="display:none">Meekijker</span></div>
            <div style="display:flex;gap:8px;align-items:center"><input id="search" placeholder="Zoek vak of notitie..." style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.04)"><button class="icon-btn" id="close-sidebar" title="Sluit menu">‚úï</button></div>
        </div>
    </aside>

    <main class="main">
        <header class="app-header">
            <div class="header-left">
                <button class="icon-btn" id="hamburger" aria-label="Toon menu">‚ò∞</button>
                <div class="title" id="page-title">Home</div>
            </div>

            <div class="header-actions">
                <div class="user-pill" id="user-pill"><span id="user-name">Gast</span></div>
                <button class="icon-btn" id="signout" title="Uitloggen">Uitloggen</button>
            </div>
        </header>

        <section class="content">

            <!-- HOME -->
            <article id="page-home" class="fade-in">
                <div class="hero">
                    <div class="hero-left">
                        <h1>Welkom bij Study-Start üéâ</h1>
                        <p class="muted">Snel plannen, notities beheren en je focus verbeteren. Kies hieronder waar je mee wil starten.</p>
                        <div class="hero-cta">
                            <button class="btn" data-link="planning">Open Agenda</button>
                            <button class="btn ghost" data-link="notities">Mijn Notities</button>
                        </div>
                    </div>
                    <div class="hero-visual">Illustratie / screenshot</div>
                </div>
            </article>

            <!-- PLANNER & TOOLS -->
            <article id="page-planning" style="display:none">
                <div class="grid-2">
                    <div>
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                            <h2>Agenda</h2>
                            <div class="muted-sm">Je planning overzicht</div>
                        </div>

                        <div class="card">
                            <div id="planner-placeholder" class="muted">Laden...</div>
                            <table id="planner-table" class="planner-table" style="display:none">
                                <thead>
                                    <tr><th>Week</th><th>Vak + Taken</th><th>Bijles / Extra</th><th style="width:80px;text-align:center">Gedaan?</th></tr>
                                </thead>
                                <tbody id="planner-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <aside>
                        <div class="card">
                            <h3>‚ö° Snel Inplannen</h3>
                            <div style="display:flex;flex-direction:column;gap:8px">
                                <input id="quick-subject" placeholder="Vak (bijv. Wiskunde)">
                                <input id="quick-date" type="date">
                                <button class="btn" id="quick-plan">Inplannen</button>
                            </div>
                        </div>

                        <div class="card" style="margin-top:12px">
                            <h3>üìå Mijn Toetsen</h3>
                            <div id="tests-list">Laden...</div>
                        </div>
                    </aside>
                </div>
            </article>

            <!-- CIJFERS -->
            <article id="page-cijfers" style="display:none">
                <div style="max-width:720px">
                    <h2>Cijfers</h2>
                    <div class="card">
                        <div style="display:flex;gap:8px">
                            <input id="grade-subject" placeholder="Vak" style="flex:2">
                            <input id="grade-value" type="number" placeholder="Cijfer" step="0.1" style="flex:1">
                            <button class="btn" id="grade-add">Opslaan</button>
                        </div>
                    </div>

                    <div class="card" style="margin-top:12px">
                        <div id="grades-list">Laden...</div>
                    </div>
                </div>
            </article>

            <!-- NOTITIES -->
            <article id="page-notities" style="display:none">
                <div style="display:flex;gap:14px;align-items:flex-start">
                    <div style="width:260px;flex-shrink:0">
                        <div class="card">
                            <h3>+ Nieuwe Notitie</h3>
                            <button class="btn" id="new-note">Lege Notitie</button>
                        </div>
                    </div>

                    <div style="flex:1">
                        <h2>Notities</h2>
                        <p class="muted">Klik op een notitie om te openen of te bewerken.</p>
                        <div id="notes-list" class="notes-grid"></div>
                    </div>
                </div>
            </article>

            <!-- TIMER -->
            <article id="page-timer" style="display:none">
                <div style="display:flex;justify-content:center">
                    <div class="card" style="max-width:480px;width:100%;text-align:center">
                        <h2>Focus Timer</h2>
                        <div id="timer-display" class="timer-large">25:00</div>
                        <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
                            <input id="timer-minutes" type="number" value="25" min="1" style="width:88px;text-align:center;padding:8px;border-radius:8px">
                        </div>
                        <div class="timer-controls" style="margin-top:14px">
                            <button class="btn" id="timer-start">Start</button>
                            <button class="icon-btn" id="timer-pause">Pauze</button>
                            <button class="icon-btn" id="timer-reset">Reset</button>
                        </div>
                    </div>
                </div>
            </article>

            <!-- INSTELLINGEN -->
            <article id="page-instellingen" style="display:none">
                <div style="max-width:540px">
                    <h2>Instellingen</h2>
                    <div class="card">
                        <label class="muted-sm">Profielnaam</label>
                        <input id="settings-name" placeholder="Naam...">
                        <div style="display:flex;gap:8px;margin-top:10px"><button class="btn" id="save-settings">Opslaan</button></div>
                    </div>
                </div>
            </article>

        </section>
    </main>

    <button class="fab" id="mobile-new" title="Nieuwe notitie">Ôºã</button>
</div>

<!-- Modal (notities) -->
<div id="note-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="note-modal-title">
    <div class="modal-card">
        <div class="modal-header">
            <div id="note-modal-title">Notitie</div>
            <div style="display:flex;gap:8px">
                <button class="icon-btn" id="modal-delete">üóëÔ∏è</button>
                <button class="icon-btn" id="modal-close">Sluiten</button>
            </div>
        </div>
        <div class="modal-body">
            <input id="note-title" placeholder="Titel..." style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(15,23,42,0.04);margin-bottom:10px">
            <div id="note-editor" class="editor" contenteditable="true" aria-label="Notitie inhoud"></div>
            <div style="margin-top:12px;display:flex;justify-content:flex-end;gap:8px">
                <button class="btn" id="modal-save">Opslaan</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ----------------- Lightweight helpers & state -----------------
    const pages = ['home','planning','cijfers','notities','timer','instellingen'];
    const state = {current:'home', sidebarOpen:false, timer:null, timeLeft:25*60, currentNoteId:null};

    // Basic DOM refs
    const sidebar = document.getElementById('sidebar');
    const hamburger = document.getElementById('hamburger');
    const navButtons = [...document.querySelectorAll('.nav button')];
    const pageElems = pages.reduce((acc,p)=>{acc[p]=document.getElementById('page-'+p);return acc},{})

    function setActivePage(id){
        pages.forEach(p=>{ if(pageElems[p]) pageElems[p].style.display = p===id ? (p==='home' ? 'block' : 'block') : 'none'; });
        navButtons.forEach(b=>b.classList.toggle('active', b.dataset.target===id));
        document.getElementById('page-title').innerText = ({home:'Home',planning:'Agenda',cijfers:'Cijfers',notities:'Notities',timer:'Timer',instellingen:'Instellingen'})[id] || 'Overzicht';
        state.current = id;
        // close sidebar on small screens
        if(window.innerWidth<=1000){ sidebar.classList.remove('open'); }
    }

    // init nav
    navButtons.forEach(b=>b.addEventListener('click', ()=>setActivePage(b.dataset.target)));
    document.querySelectorAll('[data-link]').forEach(btn=>btn.addEventListener('click', e=>setActivePage(e.currentTarget.dataset.link)));

    // hamburger
    hamburger.addEventListener('click', ()=>{ sidebar.classList.toggle('open'); });
    document.getElementById('close-sidebar').addEventListener('click', ()=>sidebar.classList.remove('open'));
    document.getElementById('go-home').addEventListener('click', ()=>setActivePage('home'));

    // ---------- NOTES (safer rendering, avoid innerHTML where possible) ----------
    const notesList = document.getElementById('notes-list');
    const noteModal = document.getElementById('note-modal');
    const noteEditor = document.getElementById('note-editor');

    // Simple in-memory note storage for demo (replace by your firestore reads/writes in production)
    const demoNotes = [
        {id:'n1', title:'Samenvatting Wiskunde', content:'Kort overzicht van hoofdstuk 1...'},
        {id:'n2', title:'Engels - woordjes', content:'new: vocabulary, practise daily'},
    ];

    function renderNotes(list){
        notesList.innerHTML='';
        if(!list.length) { notesList.innerHTML = '<div class="muted">Nog geen notities. Maak er een met "+ Nieuwe Notitie"</div>'; return; }

        list.forEach(n=>{
            const card=document.createElement('div'); card.className='note-preview card';
            card.tabIndex=0; card.setAttribute('role','button');
            const title = document.createElement('div'); title.className='note-title'; title.textContent = n.title;
            const body = document.createElement('div'); body.className='note-body'; body.textContent = n.content;
            card.appendChild(title); card.appendChild(body);
            // pdf-badge demo
            if(n.pdf) { const pdfBadge=document.createElement('div'); pdfBadge.className='pdf-badge'; pdfBadge.textContent='üìé PDF'; card.appendChild(pdfBadge); }

            card.addEventListener('click', ()=>openNote(n.id));
            notesList.appendChild(card);
        });
    }

    function openNote(id){
        const note = demoNotes.find(n=>n.id===id);
        if(!note) return;
        state.currentNoteId = id;
        document.getElementById('note-title').value = note.title;
        noteEditor.innerText = note.content;
        noteModal.classList.add('open');
        noteEditor.focus();
    }

    document.getElementById('new-note').addEventListener('click', ()=>{
        const newNote = {id:'n'+(Date.now()), title:'Nieuwe Notitie', content:''};
        demoNotes.unshift(newNote);
        renderNotes(demoNotes);
        openNote(newNote.id);
    });

    document.getElementById('modal-close').addEventListener('click', ()=>{ noteModal.classList.remove('open'); state.currentNoteId=null });
    document.getElementById('modal-delete').addEventListener('click', ()=>{
        if(!state.currentNoteId) return; if(!confirm('Notitie verwijderen?')) return;
        const idx = demoNotes.findIndex(n=>n.id===state.currentNoteId); if(idx>=0) demoNotes.splice(idx,1);
        renderNotes(demoNotes); noteModal.classList.remove('open'); state.currentNoteId=null;
    });
    document.getElementById('modal-save').addEventListener('click', ()=>{
        const title = document.getElementById('note-title').value.trim() || 'Geen titel';
        const content = noteEditor.innerText.trim();
        if(state.currentNoteId){
            const note = demoNotes.find(n=>n.id===state.currentNoteId); if(note){note.title=title;note.content=content}
        }
        renderNotes(demoNotes); noteModal.classList.remove('open'); state.currentNoteId=null;
    });

    // close modal on ESC
    window.addEventListener('keydown', e=>{ if(e.key==='Escape'){ noteModal.classList.remove('open'); sidebar.classList.remove('open'); } });

    // quick render notes at start
    renderNotes(demoNotes);

    // ---------- PLANNER (demo rendering) ----------
    const plannerBody = document.getElementById('planner-body');
    const plannerTable = document.getElementById('planner-table');
    const plannerPlaceholder = document.getElementById('planner-placeholder');

    // demo planner items
    const demoPlanner = [
        {id:'p1', week:12, range:'17 mrt - 23 mrt', vak:'Wiskunde', thuis:'Oefen algebra hoofdstuk 1-2', bijles:'-', done:false},
        {id:'p2', week:13, range:'24 mrt - 30 mrt', vak:'Engels', thuis:'Leer woordjes H3', bijles:'Extra spreekles', done:true}
    ];

    function renderPlanner(items){
        plannerPlaceholder.style.display='none'; plannerTable.style.display='table'; plannerBody.innerHTML='';
        items.forEach(it=>{
            const tr=document.createElement('tr');
            const td1=document.createElement('td'); td1.innerHTML=`<div class='planner-week'>W${it.week}</div><div class='week-range'>${it.range}</div>`;
            const td2=document.createElement('td'); td2.innerHTML=`<div style='font-weight:700;color:var(--primary)'>${it.vak}</div><div class='muted-sm'>${it.thuis}</div>`;
            const td3=document.createElement('td'); td3.textContent = it.bijles||'-';
            const td4=document.createElement('td'); td4.style.textAlign='center'; td4.innerHTML = `<input type='checkbox' ${it.done?'checked':''}>`;
            tr.appendChild(td1);tr.appendChild(td2);tr.appendChild(td3);tr.appendChild(td4); plannerBody.appendChild(tr);
        });
    }
    renderPlanner(demoPlanner);

    // ---------- TESTS LIST ----------
    document.getElementById('tests-list').innerHTML = demoPlanner.map(t=>`<div style='display:flex;justify-content:space-between;padding:8px 0'><div><strong style='color:var(--primary)'>${t.vak}</strong><div class='muted-sm'>${t.range}</div></div><button class='icon-btn' title='Verwijder'>‚ùå</button></div>`).join('');

    // ---------- GRADES (demo) ----------
    const gradesList = document.getElementById('grades-list');
    const demoGrades = [{s:'Wiskunde', g:7.8},{s:'Nederlands', g:5.2}];
    function renderGrades(){ gradesList.innerHTML = demoGrades.map(d=>`<div style='display:flex;justify-content:space-between;padding:8px;border-radius:8px;margin-bottom:8px;background:var(--card)'><div style='font-weight:600'>${d.s}</div><div style='font-weight:800;color:${d.g>=5.5?'#16a34a':'#ef4444'}'>${d.g}</div></div>`).join(''); }
    renderGrades();

    document.getElementById('grade-add').addEventListener('click', ()=>{
        const s=document.getElementById('grade-subject').value.trim(); const g=parseFloat(document.getElementById('grade-value').value);
        if(!s || isNaN(g)) return alert('Vul vak en cijfer in'); demoGrades.unshift({s,g}); renderGrades(); document.getElementById('grade-subject').value='';document.getElementById('grade-value').value='';
    });

    // ---------- TIMER ----------
    const timerDisplay = document.getElementById('timer-display');
    const timerMinutes = document.getElementById('timer-minutes');

    function updateTimerUI(){
        const m = Math.floor(state.timeLeft/60).toString().padStart(2,'0'); const s = (state.timeLeft%60).toString().padStart(2,'0');
        timerDisplay.textContent = `${m}:${s}`; document.title = `${m}:${s} ‚Äî Focus`;
    }

    document.getElementById('timer-start').addEventListener('click', ()=>{
        if(state.timer){ clearInterval(state.timer); state.timer=null; return; }
        state.timeLeft = (parseInt(timerMinutes.value)||25)*60; updateTimerUI();
        state.timer = setInterval(()=>{ if(state.timeLeft>0){ state.timeLeft--; updateTimerUI(); } else { clearInterval(state.timer); state.timer=null; alert('Klaar!'); } },1000);
    });
    document.getElementById('timer-reset').addEventListener('click', ()=>{ clearInterval(state.timer); state.timer=null; state.timeLeft = (parseInt(timerMinutes.value)||25)*60; updateTimerUI(); });

    // ---------- small features ----------
    document.getElementById('signout').addEventListener('click', ()=>{ alert('Uitloggen (demo)'); });
    document.getElementById('mobile-new').addEventListener('click', ()=>{ document.getElementById('new-note').click(); });

    // init
    setActivePage('home'); updateTimerUI();

</script>
</body>
</html>
