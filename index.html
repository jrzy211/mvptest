<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study-Start - De Georganiseerde Studieplanner</title>

    <!-- Firebase SDK's laden (Compatibele versies voor eenvoudige JS-integratie) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- FullCalendar CSS & JS via CDN voor de kalender -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/locales-all.global.min.js"></script>

    <style>
        /* Algemene styling */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Paginaweergaven */
        #login-page, #planner-page {
            flex-grow: 1;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        /* Login Pagina Styling (Jouw Landingspagina) */
        #login-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background-color: #ffffff; /* Wit als basis voor jouw ontwerp */
            padding-top: 100px;
        }

        .login-card {
            max-width: 400px;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            background-color: white;
        }

        .login-card h1 {
            color: #1e8449;
            margin-bottom: 30px;
            border-bottom: none;
        }
        
        /* Google Login Knop */
        #google-login-button {
            background-color: #4285F4; /* Google Blue */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            margin: 0 auto;
        }

        #google-login-button:hover {
            background-color: #357ae8;
        }

        .google-icon {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            background-color: white;
            padding: 5px;
            border-radius: 2px;
        }

        /* Planner Pagina Styling */
        header {
            width: 100%;
            background-color: #27ae60;
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            margin: 0;
            color: white;
            font-size: 1.5em;
            border-bottom: none;
            padding-bottom: 0;
        }

        #logout-button {
            background-color: #c0392b;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        /* Overige Planner Elementen */
        .studie-tabel {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            margin-bottom: 30px;
        }
        
        /* De rest van de tabel CSS... */
        .studie-tabel th, .studie-tabel td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }

        .studie-tabel th {
            background-color: #27ae60;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }

        .studie-tabel tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .vakantie-row {
            background-color: #ffeeaa !important;
            font-weight: bold;
            text-align: center !important;
        }
        .vakantie-row td {
            color: #8b4513;
        }

        .taak-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .taak-item input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #27ae60;
            cursor: pointer;
        }

        .taak-item.completed {
            text-decoration: line-through;
            color: #888;
        }

        .status-cell {
            font-size: 0.9em;
            color: #444;
            border-left: 3px solid #27ae60;
            padding-left: 10px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .studie-tabel, .studie-tabel tbody, .studie-tabel tr, .studie-tabel td {
                display: block;
                width: 100%;
            }
            .studie-tabel thead {
                display: none;
            }
            .studie-tabel td {
                border: none;
                border-bottom: 1px solid #eee;
                position: relative;
                padding-left: 50%;
                text-align: right;
            }
            .studie-tabel td:before {
                content: attr(data-label);
                position: absolute;
                left: 6px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                text-align: left;
                font-weight: bold;
                color: #1e8449;
            }
        }
    </style>
</head>
<body>

    <!-- 1. LANDINGSPAGINA (Zichtbaar als NIET ingelogd) -->
    <div id="login-page" style="display: none;">
        <!-- Dit is de plek voor JOUW afbeelding en ontwerp -->
        <div class="login-card">
            <h1>Welkom bij Study-Start</h1>
            <p>Jouw persoonlijke studieplanner, agenda en progressietracker in รฉรฉn. Log in om je studie-overzicht te laden.</p>
            
            <!-- De Google Login Knop -->
            <button id="google-login-button" onclick="signInWithGoogle()">
                <img src="https://upload.wikimedia.org/wikipedia/commons/4/4a/Logo_2013_Google.png" alt="Google logo" class="google-icon">
                Inloggen met Google
            </button>

            <!-- Statusmelding -->
            <p id="login-status-splash" style="margin-top: 20px; font-size: 0.9em; color: #888;">Controleert inlogstatus...</p>
        </div>
    </div>

    <!-- 2. PLANNER PAGINA (Zichtbaar als WEL ingelogd) -->
    <div id="planner-page" style="display: none;">
        <header>
            <h1 id="planner-header">Study-Start</h1>
            <div style="display: flex; align-items: center;">
                <span id="login-status-header" style="margin-right: 15px; font-size: 0.9em;"></span>
                <button id="logout-button" onclick="signOutUser()">Uitloggen</button>
            </div>
        </header>

        <div style="padding: 20px;">
            <p id="welkom-boodschap" style="font-size: 1.1em; color: #27ae60; font-weight: 500;">Welkom!</p>
            
            <!-- KALENDER SECTIE -->
            <div id="kalender-container" style="margin-bottom: 50px;">
                <h2>๐๏ธ Mijn Persoonlijke Studieplanning</h2>
                <p>Bekijk en beheer alle deadlines en bijlessen in de kalenderweergave.</p>
                <div id='kalender'></div>
            </div>
            <!-- EINDE KALENDER SECTIE -->

            <!-- PLANNER TABEL -->
            <h2 style="color: #333;">๐ Overzicht en Progressie</h2>
            <table class="studie-tabel">
                <thead>
                    <tr>
                        <th style="width: 15%;">WEEK (Deadline)</th>
                        <th style="width: 10%;">Vak</th>
                        <th style="width: 30%;">THUIS DOEN (Voorbereiden)</th>
                        <th style="width: 25%;">IN DE BIJLES (Samen doen)</th>
                        <th style="width: 20%;">STATUS & TOETSEN</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- WEEK 48 -->
                    <tr id="week-48">
                        <td data-label="WEEK">WEEK 48<br>(t/m zo 30 nov)</td>
                        <td data-label="Vak">NaSk<br>Wis H3<br>Bio</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="48" data-taak="nask1">
                                <input type="checkbox" id="nask1"><label for="nask1">โข NaSk H5: ยง1 en ยง2</label>
                            </div>
                            <div class="taak-item" data-week="48" data-taak="wis1">
                                <input type="checkbox" id="wis1"><label for="wis1">โข Wis H3: ยง1</label>
                            </div>
                            <div class="taak-item" data-week="48" data-taak="bio1">
                                <input type="checkbox" id="bio1"><label for="bio1">โข Bio H8: ยง8.1</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">N.v.t.</td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            Start gemaakt. Focus op NL toets (27/11).
                        </td>
                    </tr>
                    <!-- WEEK 49 -->
                    <tr id="week-49">
                        <td data-label="WEEK">WEEK 49<br>(t/m zo 7 dec)</td>
                        <td data-label="Vak">NaSk<br>Wis H3<br>Bio</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="49" data-taak="nask2">
                                <input type="checkbox" id="nask2"><label for="nask2">โข NaSk H5: ยง4 (Afronden voor toets)</label>
                            </div>
                            <div class="taak-item" data-week="49" data-taak="wis2">
                                <input type="checkbox" id="wis2"><label for="wis2">โข Wis H3: ยง2</label>
                            </div>
                            <div class="taak-item" data-week="49" data-taak="bio2">
                                <input type="checkbox" id="bio2"><label for="bio2">โข Bio H8: ยง8.2</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">
                            <div class="taak-item" data-week="49" data-taak="bijles_nask1">
                                <input type="checkbox" id="bijles_nask1"><label for="bijles_nask1">Bijles 04/12 (NaSk): Samen ยง3 maken & uitleg.</label>
                            </div>
                            <div class="taak-item" data-week="49" data-taak="bijles_nask2">
                                <input type="checkbox" id="bijles_nask2"><label for="bijles_nask2">Bijles 09/12 (NaSk): Proeftoets maken / Herhalen.</label>
                            </div>
                        </td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            NaSk H5 is klaar voor toets.<br>Wiskunde & Bio lopen mooi mee.
                        </td>
                    </tr>
                    <!-- WEEK 50 -->
                    <tr id="week-50">
                        <td data-label="WEEK">WEEK 50<br>(t/m zo 14 dec)</td>
                        <td data-label="Vak">Wis H3<br>Bio<br>Wis H1</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="50" data-taak="wis3">
                                <input type="checkbox" id="wis3"><label for="wis3">โข Wis H3: ยง3</label>
                            </div>
                            <div class="taak-item" data-week="50" data-taak="bio3">
                                <input type="checkbox" id="bio3"><label for="bio3">โข Bio H8: ยง8.3</label>
                            </div>
                            <div class="taak-item" data-week="50" data-taak="wis_resit1">
                                <input type="checkbox" id="wis_resit1"><label for="wis_resit1">โข Wis H1 (Resit): ยง1 en ยง2</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">
                            <span style="font-weight: bold; color: red;">NaSk Toets (10/12)</span><br>
                            <div class="taak-item" data-week="50" data-taak="bijles_wis1">
                                <input type="checkbox" id="bijles_wis1"><label for="bijles_wis1">Bijles 16/12 (Wis): Samen ยง4 maken (lastige stof).</label>
                            </div>
                        </td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            NaSk is afgerond.<br>Focus verschuift naar Wiskunde.
                        </td>
                    </tr>
                    <!-- WEEK 51 -->
                    <tr id="week-51">
                        <td data-label="WEEK">WEEK 51<br>(t/m VRIJ 19 dec)</td>
                        <td data-label="Vak">Wis H3<br>Bio<br>Wis H1</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="51" data-taak="wis4">
                                <input type="checkbox" id="wis4"><label for="wis4">โข Wis H3: Afronden</label>
                            </div>
                            <div class="taak-item" data-week="51" data-taak="bio4">
                                <input type="checkbox" id="bio4"><label for="bio4">โข Bio H8: ยง8.4 (Klaar!)</label>
                            </div>
                            <div class="taak-item" data-week="51" data-taak="wis_resit2">
                                <input type="checkbox" id="wis_resit2"><label for="wis_resit2">โข Wis H1 (Resit): ยง3</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">
                            <div class="taak-item" data-week="51" data-taak="bijles_wis2">
                                <input type="checkbox" id="bijles_wis2"><label for="bijles_wis2">Bijles 18/12 (Wis): Samen ยง5 maken & H3 afsluiten.</label>
                            </div>
                        </td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            Je bent nu KLAAR voor na de vakantie.<br>Alles voor Jan is af.<br>Alvast ยง3 van herkansing gedaan.
                        </td>
                    </tr>
                    <!-- VAKANTIE -->
                    <tr class="vakantie-row" id="week-vakantie">
                        <td data-label="WEEK" colspan="2">VAKANTIE<br>(19 dec - 5 jan)</td>
                        <td data-label="THUIS DOEN" colspan="2">๐ RUST & GENIETEN ๐<br>Geen bijles.</td>
                        <td data-label="STATUS & TOETSEN">Je hoofd leegmaken.</td>
                    </tr>
                    <!-- WEEK 2 -->
                    <tr id="week-2">
                        <td data-label="WEEK">WEEK 2<br>(t/m zo 11 jan)</td>
                        <td data-label="Vak">Wis H1<br>Wis H2</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="2" data-taak="wis_resit3">
                                <input type="checkbox" id="wis_resit3"><label for="wis_resit3">โข Wis H1: ยง4 en ยง5 (Afronden)</label>
                            </div>
                            <div class="taak-item" data-week="2" data-taak="wis_h2_1">
                                <input type="checkbox" id="wis_h2_1"><label for="wis_h2_1">โข Wis H2: ยง1 en ยง2</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">
                            <div class="taak-item" data-week="2" data-taak="bijles_bio_herhaal">
                                <input type="checkbox" id="bijles_bio_herhaal"><label for="bijles_bio_herhaal">Bijles 05/01 (Bio): Herhalen voor toets.</label>
                            </div>
                            <div class="taak-item" data-week="2" data-taak="bijles_wis_herhaal">
                                <input type="checkbox" id="bijles_wis_herhaal"><label for="bijles_wis_herhaal">Bijles 06/01 (Wis): Herhalen voor toets.</label>
                            </div>
                            <span style="font-weight: bold; color: red;">Toetsen: 08/1 (Wis) & 09/1 (Bio).</span>
                        </td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            Toetsweek!<br>In het weekend focus op Herkansing.
                        </td>
                    </tr>
                    <!-- WEEK 3 -->
                    <tr id="week-3">
                        <td data-label="WEEK">WEEK 3<br>(t/m 16 jan)</td>
                        <td data-label="Vak">Wis H1/2</td>
                        <td data-label="THUIS DOEN">
                            <div class="taak-item" data-week="3" data-taak="wis_h2_2">
                                <input type="checkbox" id="wis_h2_2"><label for="wis_h2_2">โข Wis H2: ยง3</label>
                            </div>
                        </td>
                        <td data-label="IN DE BIJLES">
                            <div class="taak-item" data-week="3" data-taak="bijles_wis_h2">
                                <input type="checkbox" id="bijles_wis_h2"><label for="bijles_wis_h2">Bijles 13/01 (Wis): Samen ยง4 (H2) maken + Vragen H1.</label>
                            </div>
                            <div class="taak-item" data-week="3" data-taak="bijles_wis_rep">
                                <input type="checkbox" id="bijles_wis_rep"><label for="bijles_wis_rep">Bijles 15/01 (Wis): Generale repetitie (Oefentoets).</label>
                            </div>
                            <span style="font-weight: bold; color: red;">Herkansing 16/01</span>
                        </td>
                        <td data-label="STATUS & TOETSEN" class="status-cell">
                            Je hebt alles behandeld.
                        </td>
                    </tr>
                </tbody>
            </table>
            <!-- EINDE PLANNER TABEL -->
        </div>
    </div>
    <!-- EINDE PLANNER PAGINA -->


    <script>
        // =================================================================
        // 1. FIREBASE INITIALISATIE EN CONFIGURATIE (met jouw gegevens)
        // =================================================================
        const firebaseConfig = {
          apiKey: "AIzaSyD_Kg4HjgBpG9QqpEuxfBklPL5-34G3RHI",
          authDomain: "study-start-c510c.firebaseapp.com",
          projectId: "study-start-c510c",
          storageBucket: "study-start-c510c.firebasestorage.app",
          messagingSenderId: "960911379164",
          appId: "1:960911379164:web:ad8648cfa2fe65f8620219",
          measurementId: "G-Z4YN3HVQTR"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore(); 
        // =================================================================


        // =================================================================
        // 2. AUTHENTICATIE FUNCTIES & PAGINASCHAKELING
        // =================================================================
        function showPage(pageId) {
            // Verberg alle hoofdcontainers
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('planner-page').style.display = 'none';
            
            // Toon de gevraagde container
            if (pageId === 'login-page') {
                 // Gebruik 'flex' voor login om de card te centreren
                document.getElementById(pageId).style.display = 'flex'; 
            } else {
                 // Gebruik 'block' of 'flex' voor de planner, afhankelijk van de header
                document.getElementById(pageId).style.display = 'block'; 
            }
        }

        function handleUser(user) {
            const welkomBoodschap = document.getElementById('welkom-boodschap');
            const loginStatusSplash = document.getElementById('login-status-splash');
            const loginStatusHeader = document.getElementById('login-status-header');

            if (user) {
                // GEBRUIKER IS INGELOGD
                const userName = user.displayName ? user.displayName.split(' ')[0] : (user.email || 'Gebruiker');
                
                welkomBoodschap.innerText = `Welkom terug, ${userName}! Dit is je persoonlijke studieomgeving.`;
                loginStatusHeader.innerText = `Ingelogd als: ${userName}`;
                
                showPage('planner-page');
                initializePlannerComponents(); // Start de kalender pas na inloggen
            } else {
                // GEBRUIKER IS UITGELOGD
                loginStatusSplash.innerText = 'Log in om je persoonlijke planner te zien.';
                showPage('login-page');
            }
        }
        
        // Hoofdluisteraar: Regelt de weergave van de pagina
        auth.onAuthStateChanged(handleUser);

        function signInWithGoogle() {
          const provider = new firebase.auth.GoogleAuthProvider();
          auth.signInWithPopup(provider).catch((error) => {
            console.error("Login Fout:", error.message);
            // Je kunt hier eventueel een foutmelding op de pagina tonen in plaats van de console.
          });
        }

        function signOutUser() {
          auth.signOut().catch((error) => {
             console.error("Uitlog Fout:", error.message);
          });
        }
        // =================================================================


        // =================================================================
        // 3. PLANNER & KALENDER LOGICA (Start alleen na succesvolle login)
        // =================================================================
        function initializePlannerComponents() {
            // A. CHECKBOX LOGICA (Blijft lokaal tot we Firestore koppelen)
            const checkboxes = document.querySelectorAll('.taak-item input[type="checkbox"]');

            const loadTasks = () => {
                checkboxes.forEach(checkbox => {
                    const taakKey = checkbox.id;
                    const isChecked = localStorage.getItem(taakKey) === 'true';
                    checkbox.checked = isChecked;
                    const taakItemDiv = checkbox.closest('.taak-item');
                    if (isChecked) {
                        taakItemDiv.classList.add('completed');
                    } else {
                        taakItemDiv.classList.remove('completed');
                    }
                });
            };

            const setupListeners = () => {
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', (event) => {
                        const taakKey = event.target.id;
                        const isChecked = event.target.checked;
                        localStorage.setItem(taakKey, isChecked);
                        
                        const taakItemDiv = event.target.closest('.taak-item');
                        if (isChecked) {
                            taakItemDiv.classList.add('completed');
                        } else {
                            taakItemDiv.classList.remove('completed');
                        }
                    });
                });
            };

            loadTasks();
            setupListeners();
            // EINDE CHECKBOX LOGICA

            
            // B. FULLCALENDAR LOGICA (Evenementen uit de tabel)
            var kalenderEl = document.getElementById('kalender');
    
            // Voorbeeld evenementen direct uit de tabel
            var events = [
                // WEEK 49
                { title: 'Bijles NaSk: uitleg ยง3', start: '2025-12-04', color: '#f39c12', allDay: false },
                { title: 'Bijles NaSk: Proeftoets', start: '2025-12-09', color: '#f39c12', allDay: false },
                // WEEK 50
                { title: 'NaSk Toets (H5)', start: '2025-12-10', color: '#c0392b' },
                { title: 'Bijles Wis: ยง4 maken', start: '2025-12-16', color: '#f39c12', allDay: false },
                // WEEK 51
                { title: 'Bijles Wis: ยง5 maken', start: '2025-12-18', color: '#f39c12', allDay: false },
                // VAKANTIE
                { title: '๐ VAKANTIE (RUST) ๐', start: '2025-12-19', end: '2026-01-05', display: 'background', color: '#ffeeaa' },
                // WEEK 2
                { title: 'Bijles Bio: Herhaling', start: '2026-01-05', color: '#f39c12', allDay: false },
                { title: 'Bijles Wis: Herhaling', start: '2026-01-06', color: '#f39c12', allDay: false },
                { title: 'Toets Wiskunde', start: '2026-01-08', color: '#c0392b' },
                { title: 'Toets Biologie', start: '2026-01-09', color: '#c0392b' },
                // WEEK 3
                { title: 'Bijles Wis: ยง4 H2 + Vragen H1', start: '2026-01-13', color: '#f39c12', allDay: false },
                { title: 'Bijles Wis: Generale Repetitie', start: '2026-01-15', color: '#f39c12', allDay: false },
                { title: 'Herkansing (H1/H2)', start: '2026-01-16', color: '#c0392b' }
            ];

            var kalender = new FullCalendar.Calendar(kalenderEl, {
                initialView: 'dayGridMonth',
                locale: 'nl',
                initialDate: '2025-12-01',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek'
                },
                events: events,
                editable: true,
            });

            kalender.render();
            // EINDE KALENDER LOGICA

        }
        // =================================================================
    </script>
</body>
</html>
